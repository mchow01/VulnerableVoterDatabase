<!DOCTYPE html>
<html lang="en">
<head>
<title>Fake Find My Voter Registration Status</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="default.css">
</head>
<body>
<h2>Fake Find My Voter Registration Status</h2>
<h3>To find your voter registration information, enter your name, date of birth, and the zip code at which you are qualified to vote. All fields required.</h3>
<form method="post">
<table>
<tr>
<th>First name:</th>
<td><input name="first_name" type="text" maxlength="15" /></td>
</tr>
<tr>
<th>Last name:</th>
<td><input name="last_name" type="text" maxlength="25" /></td>
</tr>
<tr>
<th>DOB Month:</th>
<td><select name="dob_month">
	<option selected="selected" value="0">--</option>
	<option value="1">January</option>
	<option value="2">February</option>
	<option value="3">March</option>
	<option value="4">April</option>
	<option value="5">May</option>
	<option value="6">June</option>
	<option value="7">July</option>
	<option value="8">August</option>
	<option value="9">September</option>
	<option value="10">October</option>
	<option value="11">November</option>
	<option value="12">December</option>
</select></td>
</tr>
<tr>
<th>DOB Day:</th>
<td><select name="dob_day">
	<option selected="selected" value="0">--</option>
	<option value="1">1</option>
	<option value="2">2</option>
	<option value="3">3</option>
	<option value="4">4</option>
	<option value="5">5</option>
	<option value="6">6</option>
	<option value="7">7</option>
	<option value="8">8</option>
	<option value="9">9</option>
	<option value="10">10</option>
	<option value="11">11</option>
	<option value="12">12</option>
	<option value="13">13</option>
	<option value="14">14</option>
	<option value="15">15</option>
	<option value="16">16</option>
	<option value="17">17</option>
	<option value="18">18</option>
	<option value="19">19</option>
	<option value="20">20</option>
	<option value="21">21</option>
	<option value="22">22</option>
	<option value="23">23</option>
	<option value="24">24</option>
	<option value="25">25</option>
	<option value="26">26</option>
	<option value="27">27</option>
	<option value="28">28</option>
	<option value="29">29</option>
	<option value="30">30</option>
	<option value="31">31</option>
</select></td>
<tr>
<th>DOB Year:</th>
<td><select name="dob_year">
	<option selected="selected" value="0">--</option>
	<option value="2004">2004</option>
	<option value="2003">2003</option>
	<option value="2002">2002</option>
	<option value="2001">2001</option>
	<option value="2000">2000</option>
	<option value="1999">1999</option>
	<option value="1998">1998</option>
	<option value="1997">1997</option>
	<option value="1996">1996</option>
	<option value="1995">1995</option>
	<option value="1994">1994</option>
	<option value="1993">1993</option>
	<option value="1992">1992</option>
	<option value="1991">1991</option>
	<option value="1990">1990</option>
	<option value="1989">1989</option>
	<option value="1988">1988</option>
	<option value="1987">1987</option>
	<option value="1986">1986</option>
	<option value="1985">1985</option>
	<option value="1984">1984</option>
	<option value="1983">1983</option>
	<option value="1982">1982</option>
	<option value="1981">1981</option>
	<option value="1980">1980</option>
	<option value="1979">1979</option>
	<option value="1978">1978</option>
	<option value="1977">1977</option>
	<option value="1976">1976</option>
	<option value="1975">1975</option>
	<option value="1974">1974</option>
	<option value="1973">1973</option>
	<option value="1972">1972</option>
	<option value="1971">1971</option>
	<option value="1970">1970</option>
	<option value="1969">1969</option>
	<option value="1968">1968</option>
	<option value="1967">1967</option>
	<option value="1966">1966</option>
	<option value="1965">1965</option>
	<option value="1964">1964</option>
	<option value="1963">1963</option>
	<option value="1962">1962</option>
	<option value="1961">1961</option>
	<option value="1960">1960</option>
	<option value="1959">1959</option>
	<option value="1958">1958</option>
	<option value="1957">1957</option>
	<option value="1956">1956</option>
	<option value="1955">1955</option>
	<option value="1954">1954</option>
	<option value="1953">1953</option>
	<option value="1952">1952</option>
	<option value="1951">1951</option>
	<option value="1950">1950</option>
	<option value="1949">1949</option>
	<option value="1948">1948</option>
	<option value="1947">1947</option>
	<option value="1946">1946</option>
	<option value="1945">1945</option>
	<option value="1944">1944</option>
	<option value="1943">1943</option>
	<option value="1942">1942</option>
	<option value="1941">1941</option>
	<option value="1940">1940</option>
	<option value="1939">1939</option>
	<option value="1938">1938</option>
	<option value="1937">1937</option>
	<option value="1936">1936</option>
	<option value="1935">1935</option>
	<option value="1934">1934</option>
	<option value="1933">1933</option>
	<option value="1932">1932</option>
	<option value="1931">1931</option>
	<option value="1930">1930</option>
	<option value="1929">1929</option>
	<option value="1928">1928</option>
	<option value="1927">1927</option>
	<option value="1926">1926</option>
	<option value="1925">1925</option>
	<option value="1924">1924</option>
	<option value="1923">1923</option>
	<option value="1922">1922</option>
	<option value="1921">1921</option>
	<option value="1920">1920</option>
	<option value="1919">1919</option>
	<option value="1918">1918</option>
	<option value="1917">1917</option>
	<option value="1916">1916</option>
	<option value="1915">1915</option>
	<option value="1914">1914</option>
	<option value="1913">1913</option>
	<option value="1912">1912</option>
	<option value="1911">1911</option>
	<option value="1910">1910</option>
	<option value="1909">1909</option>
	<option value="1908">1908</option>
	<option value="1907">1907</option>
	<option value="1906">1906</option>
	<option value="1905">1905</option>
	<option value="1904">1904</option>
	<option value="1903">1903</option>
	<option value="1902">1902</option>
	<option value="1901">1901</option>
	<option value="1900">1900</option>
</select></td>
</tr>
<tr>
<th>Zipcode:</th>         
<td><input name="zipcode" type="text" maxlength="5" /></td>
</tr>
</table>
<p><input type="checkbox" name="understand" />You must check this box before you can view your voting information.</p>
<input type="submit" />
</form>
<?php
  if (isset($_POST["understand"])) {
    $firstName = $_POST["first_name"];
    $lastName = $_POST["last_name"];
    $dobMonth = intval($_POST["dob_month"]);
    $dobDay = intval($_POST["dob_day"]);
    $dobYear = intval($_POST["dob_year"]);
    $zipcode = $_POST["zipcode"];
    $understand = $_POST["understand"];
    $myUserName = 'hacked';
    $myPassword = 'epicfail';
    $myDBName = 'voterdb';
    $myHost = 'database';
    $db = mysqli_connect($myHost, $myUserName, $myPassword);
    if (!$db) {
      die('Cannot connect to the database: ' . mysqli_error());
    }
    else {
      mysqli_select_db($db, $myDBName) or die("Unable to select database");
    }
    echo '<h2>Results</h2>';
    $query = "SELECT * FROM voters WHERE LOWER(first_name) = '" . mysqli_real_escape_string($db, 
    strtolower($firstName)) . "' AND LOWER(last_name) = '" . mysqli_real_escape_string($db, 
    strtolower($lastName)) . "' AND dob_month = $dobMonth AND dob_day = $dobDay AND dob_year = $dobYear AND zipcode = '" . $zipcode . "'";
    $result = mysqli_query($db, $query);
		if (!$result) {
			$message  = 'Invalid query: ' . mysqli_error($db) . "\n";
			$message .= 'Whole query: ' . $query;
			die($message);
		}
		else {
			$row = array();
			if (mysqli_num_rows($result) > 0) {
        echo '<table border="1"><tr><th>First Name</th><th>Last Name</th><th>Date of Birth</th><th>Zipcode</th></tr>';
        while ($row = mysqli_fetch_array($result)) {
          echo "<tr><td>" . $row["first_name"] . "</td><td>" . $row["last_name"] . "</td><td>" .  $row["dob_month"] . "/" . $row["dob_day"] . "/" . $row["dob_year"] . "</td><td>" . $row["zipcode"] . "</td></tr>\n";
        }
        echo '</table>';
      }
      else {
        echo "<p>No results<p>";
      }
		}
    mysqli_free_result($result);
    mysqli_close($db);
  }
?>
</body>
</html>